<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Test Stripe Checkout – TRUST UC</title>
<style>
  body{font-family:Arial;background:#f5f5f5;color:#333;display:flex;flex-direction:column;align-items:center;padding:40px}
  input,select,button{padding:10px;margin:8px;font-size:16px}
  button{background:#2e89ff;color:#fff;border:none;border-radius:6px;cursor:pointer}
  .box{background:#fff;border-radius:8px;padding:30px;box-shadow:0 2px 6px rgba(0,0,0,.1)}
</style>
</head>
<body>
<div class="box">
  <h2>Test Pagesa me Stripe Checkout</h2>
  <input id="playerId" placeholder="Player ID" required><br>
  <input id="serverId" placeholder="Server ID" required><br>
  <input id="email" type="email" placeholder="Email" required><br>
  <select id="package">
    <option value="1938299181721538561|325|4.10">325 UC – €4.10</option>
    <option value="1938300815303401474|660|8.10">660 UC – €8.10</option>
    <option value="1931436511665717249|1800|20.50">1800 UC – €20.50</option>
    <option value="1898646498683515844|3850|41.50">3850 UC – €41.50</option>
    <option value="1909194994574553089|8100|80.00">8100 UC – €80.00</option>
  </select><br>
  <button onclick="startCheckout()">Paguaj me kartë (Test)</button>
</div>

<script>
async function startCheckout(){
  const [productId, ucAmount, amount] = document.getElementById('package').value.split('|');
  const payload = {
    productId,
    ucAmount: parseInt(ucAmount),
    amount: parseFloat(amount),
    playerId: document.getElementById('playerId').value.trim(),
    serverId: document.getElementById('serverId').value.trim(),
    email: document.getElementById('email').value.trim()
  };
  if(!payload.playerId||!payload.serverId||!payload.email){
    alert('Ju lutem plotësoni të gjitha fushat!');
    return;
  }
  const r = await fetch('/.netlify/functions/createCheckoutSession',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify(payload)
  });
  const data = await r.json();
  if(data.url){
    window.location = data.url;
  }else{
    alert('Gabim: '+(data.error||'nuk u krijua sesioni'));
  }
}
</script>
</body>
</html>